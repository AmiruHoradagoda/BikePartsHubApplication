<!-- Service Selection View -->
<div
  *ngIf="!selectedService"
  class="flex items-center justify-center min-h-screen bg-slate-800"
>
  <div
    class="flex flex-col my-6 space-y-6 md:space-y-0 md:space-x-6 md:flex-row md:my-0"
  >
    <div
      *ngFor="let service of services; let i = index"
      class="text-white rounded-xl"
      [ngClass]="i === 1 ? 'bg-violet-600' : 'bg-slate-700'"
    >
      <!-- Upper Container -->
      <div class="p-8 mx-3 mt-3 rounded-t-xl bg-slate-800">
        <div class="text-center uppercase">
          {{ i === 0 ? "Basic" : i === 1 ? "Standard" : "Premium" }}
        </div>
        <h2 class="mt-10 font-serif text-5xl text-center">
          {{ service.duration }}Hr
        </h2>
        <h3 class="mt-2 text-center">Rs. {{ service.price }}/-</h3>
        <div class="flex justify-center">
          <button
            class="inline-block px-10 py-3 my-6 text-center duration-200 border rounded-lg border-violet-600"
            [ngClass]="{
              'bg-violet-600': i === 1,
              'hover:bg-violet-800 hover:border-violet-800': true
            }"
            (click)="selectService(service)"
          >
            Schedule Now
          </button>
        </div>
      </div>

      <!-- Border -->
      <div class="border-t border-slate-700"></div>

      <!-- Lower Container -->
      <div class="p-8 mx-3 mb-3 rounded-b-xl bg-slate-800">
        <div class="flex flex-col space-y-2">
          <div
            *ngFor="let feature of service.features"
            class="flex justify-center"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="w-5 h-5"
              viewBox="0 0 24 24"
              strokeWidth="2"
              stroke="currentColor"
              fill="none"
              strokeLinecap="round"
              strokeLinejoin="round"
            >
              <path stroke="none" d="M0 0h24v24H0z" fill="none" />
              <path d="M5 12l5 5l10 -10" />
            </svg>
            <span class="ml-1 text-sm">{{ feature }}</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- Appointment Booking Page -->
<div
  *ngIf="selectedService"
  class="w-full min-h-screen p-4 mx-auto bg-slate-800"
>
  <div class="mb-6">
    <button
      (click)="backToServices()"
      class="flex items-center text-violet-400 hover:text-violet-300"
    >
      <span class="mr-2">‚Üê</span> Back to Services
    </button>
  </div>

  <div class="grid grid-cols-1 gap-8 md:grid-cols-2">
    <!-- Calendar and Time Slots -->
    <div class="p-6 text-white rounded-lg shadow-md bg-slate-700">
      <h2 class="mb-4 text-xl font-bold">Select Date & Time</h2>

      <!-- PrimeNG Calendar -->
      <div class="mb-6">
        <p-calendar
          [(ngModel)]="selectedDate"
          [inline]="true"
          [showWeek]="false"
          [minDate]="minDate"
          [maxDate]="maxDate"
          [disabledDates]="disabledDates"
          (onSelect)="onDateSelect($event)"
          [readonlyInput]="true"
          styleClass="dark-theme-calendar"
          [showOtherMonths]="false"
        ></p-calendar>
      </div>
     
      <!-- Time Slots -->
      <div class="mt-6">
        <h3 class="mb-3 text-lg font-semibold text-violet-300">
          Available Time Slots
        </h3>

        <!-- Time slot legend -->
        <div class="grid grid-cols-2 gap-2 mb-4 text-sm">
          <div class="flex items-center">
            <div class="w-4 h-4 mr-2 rounded bg-green-500/20"></div>
            <span class="text-green-300">Available</span>
          </div>
          <div class="flex items-center">
            <div class="w-4 h-4 mr-2 rounded bg-yellow-500/20"></div>
            <span class="text-yellow-300">Busy (1 booking)</span>
          </div>
          <div class="flex items-center">
            <div class="w-4 h-4 mr-2 rounded bg-orange-500/20"></div>
            <span class="text-orange-300">Highly Busy (2 bookings)</span>
          </div>
          <div class="flex items-center">
            <div class="w-4 h-4 mr-2 rounded bg-slate-500/20"></div>
            <span class="text-slate-300">Not Available</span>
          </div>
        </div>

        <!-- Time slots grid -->
        <div class="grid grid-cols-2 gap-2">
          <div
            *ngFor="let status of timeSlotStatuses"
            [ngClass]="getTimeSlotClasses(status.slot)"
            (click)="selectTimeSlot(status.slot)"
          >
            <div>{{ formatTimeSlot(status.slot) }}</div>
            <div class="text-xs" *ngIf="status.status !== 'not-available'">
              ({{ 3 - status.bookedCount }} slots left)
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Booking Form -->
    <div class="p-6 text-white rounded-lg shadow-md bg-slate-700">
      <h2 class="mb-4 text-xl font-bold">Booking Details</h2>

      <form
        [formGroup]="bookingForm"
        (ngSubmit)="submitBooking()"
        class="space-y-4"
      >
        <div>
          <label class="block text-sm font-medium text-violet-300">Name</label>
          <input
            type="text"
            formControlName="name"
            class="w-full p-2 mt-1 text-white border rounded-md bg-slate-800 border-slate-600 focus:ring-2 focus:ring-violet-500 focus:border-violet-500"
          />
        </div>

        <div>
          <label class="block text-sm font-medium text-violet-300"
            >Mobile Number</label
          >
          <input
            type="tel"
            formControlName="mobile"
            class="w-full p-2 mt-1 text-white border rounded-md bg-slate-800 border-slate-600 focus:ring-2 focus:ring-violet-500 focus:border-violet-500"
          />
        </div>

        <div>
          <label class="block text-sm font-medium text-violet-300"
            >Bike Plate Number</label
          >
          <input
            type="text"
            formControlName="plateNumber"
            class="w-full p-2 mt-1 text-white border rounded-md bg-slate-800 border-slate-600 focus:ring-2 focus:ring-violet-500 focus:border-violet-500"
          />
        </div>

        <!-- Engine Oil Selection -->
        <div>
          <label class="block mb-2 text-sm font-medium text-violet-300"
            >Choose Engine Oil</label
          >
          <div class="grid grid-cols-2 gap-4">
            <div
              *ngFor="let oil of engineOils"
              class="p-4 text-center transition-colors duration-200 border rounded cursor-pointer"
              [ngClass]="
                selectedOil === oil
                  ? 'border-violet-500 bg-violet-900/50 text-violet-300'
                  : 'border-slate-600 hover:border-violet-400 text-white'
              "
              (click)="selectEngineOil(oil)"
            >
              {{ oil }}
            </div>
          </div>
        </div>

        <!-- Charges Summary -->
        <div class="p-4 mt-6 border rounded-md bg-slate-800 border-slate-600">
          <div class="flex justify-between mb-2 text-slate-300">
            <span>Service Charge:</span>
            <span>Rs. {{ selectedService.price }}/-</span>
          </div>
          <div class="flex justify-between mb-2 text-slate-300">
            <span>Add-ons:</span>
            <span>Rs. {{ addOnsCharge }}/-</span>
          </div>
          <div class="flex justify-between font-bold text-violet-300">
            <span>Estimated Total:</span>
            <span>Rs. {{ totalCharge }}/-</span>
          </div>
        </div>

        <button
          type="submit"
          [disabled]="!isFormValid()"
          class="w-full px-4 py-2 text-white transition-colors duration-200 rounded-md bg-violet-600 hover:bg-violet-700 disabled:bg-slate-600 disabled:cursor-not-allowed"
        >
          Schedule Appointment
        </button>
      </form>
    </div>
  </div>
</div>
